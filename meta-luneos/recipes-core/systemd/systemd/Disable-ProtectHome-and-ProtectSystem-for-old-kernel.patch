From 0523ba88e1d8ca5b8eb71e19209ff2ea0461e3c3 Mon Sep 17 00:00:00 2001
From: Christophe Chapuis <chris.chapuis@gmail.com>
Date: Sat, 29 Apr 2017 14:41:21 +0000
Subject: [PATCH] Disable ProtectHome and ProtectSystem for old kernels

Signed-off-by: Christophe Chapuis <chris.chapuis@gmail.com>

---
 src/core/namespace.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/core/namespace.c b/src/core/namespace.c
index 70089f212..e157c9974 100644
--- a/src/core/namespace.c
+++ b/src/core/namespace.c
@@ -1469,7 +1469,8 @@ DEFINE_STRING_TABLE_LOOKUP(protect_home, ProtectHome);
 ProtectHome parse_protect_home_or_bool(const char *s) {
         int r;
 
-        r = parse_boolean(s);
+        /* r = parse_boolean(s); */
+        r = 0; /* Disable protection for old kernels */
         if (r > 0)
                 return PROTECT_HOME_YES;
         if (r == 0)
@@ -1490,7 +1491,8 @@ DEFINE_STRING_TABLE_LOOKUP(protect_system, ProtectSystem);
 ProtectSystem parse_protect_system_or_bool(const char *s) {
         int r;
 
-        r = parse_boolean(s);
+        /* r = parse_boolean(s); */
+        r = 0; /* Disable protection for old kernels */
         if (r > 0)
                 return PROTECT_SYSTEM_YES;
         if (r == 0)
